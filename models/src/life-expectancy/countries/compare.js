const csv = require('csv-parser');
const stripBom = require('strip-bom-stream');
const fs = require('fs');
const countryInterface =
	'export interface Country {' +
	'country: string;' +
	'alpha2: string;' +
	'alpha3: string;' +
	'numeric: number;' +
	'male: number | null;' +
	'female: number | null;' +
	'overall: number | null;' +
	'}';
const lifeExpectancies = [
	{ country: 'Japan', male: 84.5, female: 87.5, overall: 81.1 },
	{ country: 'Hong Kong', male: 84.1, female: 87, overall: 81.2 },
	{ country: 'Singapore', male: 83.8, female: 85.8, overall: 81.5 },
	{ country: 'Italy', male: 83.6, female: 85.5, overall: 81.7 },
	{ country: 'Spain', male: 83.4, female: 86.1, overall: 80.7 },
	{ country: 'Switzerland', male: 83.4, female: 85.3, overall: 81.1 },
	{ country: 'Australia', male: 83.3, female: 85.3, overall: 81.3 },
	{ country: 'Iceland', male: 82.9, female: 84.4, overall: 81.3 },
	{ country: 'Israel', male: 82.8, female: 84.4, overall: 81.1 },
	{ country: 'South Korea', male: 82.8, female: 85.8, overall: 79.7 },
	{ country: 'Sweden', male: 82.7, female: 84.4, overall: 80.9 },
	{ country: 'France', male: 82.5, female: 85.4, overall: 79.6 },
	{ country: 'Malta', male: 82.4, female: 84.1, overall: 80.5 },
	{ country: 'Canada', male: 82.3, female: 84.3, overall: 80.3 },
	{ country: 'Norway', male: 82.3, female: 84.3, overall: 80.3 },
	{ country: 'Greece', male: 82.1, female: 84.5, overall: 79.6 },
	{ country: 'Ireland', male: 82.1, female: 83.7, overall: 80.4 },
	{ country: 'Luxembourg', male: 82.1, female: 84.2, overall: 80 },
	{ country: 'Netherlands', male: 82.1, female: 83.8, overall: 80.4 },
	{ country: 'New Zealand', male: 82.1, female: 83.9, overall: 80.4 },
	{ country: 'Portugal', male: 81.9, female: 84.7, overall: 78.8 },
	{ country: 'Andorra', male: 81.8, female: null, overall: null },
	{ country: 'Finland', male: 81.7, female: 84.6, overall: 78.9 },
	{
		country: 'Saint Helena, Ascension and Tristan da Cunha',
		male: 81.5,
		female: 83.8,
		overall: 79.1,
	},
	{ country: 'Belgium', male: 81.5, female: 83.8, overall: 79.1 },
	{ country: 'Austria', male: 81.4, female: 83.8, overall: 79 },
	{ country: 'Germany', male: 81.2, female: 83.6, overall: 78.8 },
	{ country: 'Slovenia', male: 81.2, female: 83.9, overall: 78.4 },
	{ country: 'United Kingdom', male: 81.2, female: 83, overall: 79.5 },
	{ country: 'Cyprus', male: 80.8, female: 82.9, overall: 78.7 },
	{ country: 'Denmark', male: 80.8, female: 82.8, overall: 77.8 },
	{ country: 'Liechtenstein', male: 80.5, female: null, overall: null },
	{ country: 'Costa Rica', male: 80.1, female: 82.7, overall: 77.5 },
	{ country: 'Chile', male: 80, female: 82.4, overall: 77.6 },
	{ country: 'Czech Republic', male: 79.2, female: 81.8, overall: 76.6 },
	{ country: 'Barbados', male: 79.1, female: 80.4, overall: 77.7 },
	{ country: 'Lebanon', male: 78.9, female: 80.8, overall: 77.1 },
	{ country: 'United States of America', male: 78.9, female: 81.4, overall: 76.3 },
	{ country: 'Cuba', male: 78.6, female: 80.6, overall: 76.7 },
	{ country: 'Estonia', male: 78.6, female: 82.4, overall: 73.9 },
	{ country: 'Poland', male: 78.5, female: 82.4, overall: 74.6 },
	{ country: 'Croatia', male: 78.3, female: 81.5, overall: 75.1 },
	{ country: 'Panama', male: 78.3, female: 81.6, overall: 75.2 },
	{ country: 'Turkey', male: 78.3, female: 81, overall: 75.6 },
	{ country: 'United Arab Emirates', male: 77.8, female: 79.2, overall: 77.1 },
	{ country: 'Uruguay', male: 77.8, female: 81.4, overall: 74 },
	{ country: 'Oman', male: 77.6, female: 80.1, overall: 75.9 },
	{ country: 'Slovakia', male: 77.4, female: 80.8, overall: 73.8 },
	{ country: 'Bosnia and Herzegovina', male: 77.3, female: 79.7, overall: 74.8 },
	{ country: 'Bahrain', male: 77.2, female: 78.3, overall: 76.3 },
	{ country: 'Colombia', male: 77.1, female: 79.9, overall: 74.3 },
	{ country: 'Antigua and Barbuda', male: 76.9, female: 78, overall: 75.7 },
	{ country: 'Thailand', male: 76.9, female: 80.7, overall: 73.2 },
	{ country: 'Ecuador', male: 76.8, female: 79.6, overall: 74.1 },
	{ country: 'Montenegro', male: 76.8, female: 79.2, overall: 74.3 },
	{ country: 'Sri Lanka', male: 76.8, female: 80.1, overall: 73.4 },
	{ country: 'Algeria', male: 76.7, female: 77.9, overall: 75.5 },
	{ country: 'Hungary', male: 76.7, female: 80.1, overall: 73.1 },
	{ country: 'China', male: 76.7, female: 79.1, overall: 74.5 },
	{ country: 'Argentina', male: 76.5, female: 79.9, overall: 73.1 },
	{ country: 'Iran', male: 76.5, female: 77.7, overall: 75.4 },
	{ country: 'Morocco', male: 76.5, female: 77.7, overall: 75.2 },
	{ country: 'Peru', male: 76.5, female: 79.3, overall: 73.8 },
	{ country: 'Tunisia', male: 76.5, female: 78.5, overall: 74.5 },
	{ country: 'Malaysia', male: 76.1, female: 78.3, overall: 74.2 },
	{ country: 'Saint Lucia', male: 76.1, female: 77.4, overall: 74.7 },
	{ country: 'Romania', male: 75.9, female: 79.4, overall: 72.5 },
	{ country: 'Serbia', male: 75.8, female: 78.5, overall: 73.3 },
	{ country: 'Brazil', male: 75.7, female: 79.4, overall: 72 },
	{ country: 'Brunei', male: 75.7, female: 77, overall: 74.6 },
	{ country: 'Lithuania', male: 75.7, female: 81.2, overall: 70.1 },
	{ country: 'Republic of North Macedonia', male: 75.7, female: 77.7, overall: 73.7 },
	{ country: 'Kuwait', male: 75.4, female: 76.5, overall: 74.7 },
	{ country: 'Vietnam', male: 75.3, female: 79.4, overall: 71.2 },
	{ country: 'Latvia', male: 75.2, female: 79.9, overall: 70.1 },
	{ country: 'Honduras', male: 75.1, female: 77.4, overall: 72.8 },
	{ country: 'Mexico', male: 75, female: 77.8, overall: 72.1 },
	{ country: 'Saudi Arabia', male: 75, female: 76.6, overall: 73.8 },
	{ country: 'Armenia', male: 74.9, female: 78.4, overall: 71.2 },
	{ country: 'Bulgaria', male: 74.9, female: 78.5, overall: 71.4 },
	{ country: 'Mauritius', male: 74.9, female: 78.4, overall: 71.5 },
	{ country: 'Belarus', male: 74.6, female: 79.4, overall: 69.4 },
	{ country: 'Saint Kitts and Nevis', male: 74.6, female: null, overall: null },
	{ country: 'Belize', male: 74.5, female: 77.7, overall: 71.6 },
	{ country: 'Jamaica', male: 74.4, female: 76, overall: 72.8 },
	{ country: 'Jordan', male: 74.4, female: 76.2, overall: 72.7 },
	{ country: 'Nicaragua', male: 74.3, female: 77.8, overall: 70.7 },
	{ country: 'Guatemala', male: 74.1, female: 76.9, overall: 71.1 },
	{ country: 'Paraguay', male: 74.1, female: 76.3, overall: 72.2 },
	{ country: 'Dominican Republic', male: 73.9, female: 77.2, overall: 70.8 },
	{ country: 'Marshall Islands', male: 73.9, female: null, overall: null },
	{ country: 'Palestine', male: 73.9, female: 75.6, overall: 72.3 },
	{ country: 'Bahamas', male: 73.8, female: 75.9, overall: 71.5 },
	{ country: 'Palau', male: 73.7, female: null, overall: null },
	{ country: 'Georgia', male: 73.6, female: 78, overall: 69.2 },
	{ country: 'Trinidad and Tobago', male: 73.4, female: 76.1, overall: 70.8 },
	{ country: 'Seychelles', male: 73.3, female: 77.3, overall: 69.8 },
	{ country: 'Kazakhstan', male: 76.2, female: 77.3, overall: 68.8 },
	{ country: 'Samoa', male: 73.2, female: 75.3, overall: 71.2 },
	{ country: 'El Salvador', male: 73.1, female: 77.6, overall: 68.2 },
	{ country: 'Azerbaijan', male: 72.9, female: 75.3, overall: 70.3 },
	{ country: 'Cabo Verde', male: 72.8, female: 76, overall: 69.3 },
	{ country: 'Solomon Islands', male: 72.8, female: 74.7, overall: 71.2 },
	{ country: 'Libya', male: 72.7, female: 75.8, overall: 69.9 },
	{ country: 'Grenada', male: 72.4, female: 74.9, overall: 70.1 },
	{ country: 'Russian Federation', male: 72.4, female: 77.6, overall: 66.9 },
	{ country: 'Saint Vincent and the Grenadines', male: 72.4, female: 75, overall: 70.2 },
	{ country: 'Bangladesh', male: 72.3, female: 74.3, overall: 70.6 },
	{ country: 'Venezuela', male: 72.1, female: 76.1, overall: 68.4 },
	{ country: 'Ukraine', male: 72, female: 76.7, overall: 67 },
	{ country: 'Egypt', male: 71.8, female: 74.2, overall: 69.6 },
	{ country: 'Moldova', male: 71.8, female: 76.1, overall: 67.5 },
	{ country: 'Syria', male: 71.8, female: 77.8, overall: 66.6 },
	{ country: 'Suriname', male: 71.6, female: 74.9, overall: 68.4 },
	{ country: 'Uzbekistan', male: 74.6, female: 73.7, overall: 69.4 },
	{ country: 'Bhutan', male: 71.5, female: 71.8, overall: 71.1 },
	{ country: 'Indonesia', male: 71.5, female: 73.7, overall: 69.4 },
	{ country: 'Kyrgyzstan', male: 71.3, female: 75.5, overall: 67.3 },
	{ country: 'Bolivia', male: 71.2, female: 74.2, overall: 68.4 },
	{ country: 'Philippines', male: 71.1, female: 75.4, overall: 67.1 },
	{ country: 'Tajikistan', male: 70.9, female: 73.2, overall: 68.7 },
	{ country: 'Tonga', male: 70.8, female: 72.8, overall: 68.9 },
	{ country: 'Iraq', male: 70.5, female: 72.5, overall: 68.4 },
	{ country: 'Nepal', male: 70.5, female: 71.9, overall: 69 },
	{ country: 'Vanuatu', male: 70.3, female: 72, overall: 68.8 },
	{ country: 'Sao Tome and Principe', male: 70.2, female: 72.6, overall: 67.8 },
	{ country: 'Guyana', male: 69.8, female: 73, overall: 66.8 },
	{ country: 'Mongolia', male: 69.7, female: 74, overall: 65.6 },
	{ country: 'Cambodia', male: 69.6, female: 71.6, overall: 67.3 },
	{ country: 'India', male: 69.4, female: 70.7, overall: 68.2 },
	{ country: 'Botswana', male: 69.3, female: 72, overall: 66.2 },
	{ country: 'Timor Leste', male: 69.3, female: 71.4, overall: 67.3 },
	{ country: 'Rwanda', male: 68.7, female: 70.8, overall: 66.5 },
	{ country: 'Kiribati', male: 68.1, female: 72.1, overall: 64 },
	{ country: 'Turkmenistan', male: 68.1, female: 71.6, overall: 64.6 },
	{ country: 'Micronesia', male: 67.8, female: 69.5, overall: 66.1 },
	{ country: 'Senegal', male: 67.7, female: 69.6, overall: 65.5 },
	{ country: 'Laos', male: 67.6, female: 69.4, overall: 65.8 },
	{ country: 'Fiji', male: 67.3, female: 69.2, overall: 65.6 },
	{ country: 'Pakistan', male: 67.1, female: 68.1, overall: 66.2 },
	{ country: 'Myanmar', male: 66.9, female: 69.9, overall: 63.8 },
	{ country: 'Madagascar', male: 66.7, female: 68.3, overall: 65.1 },
	{ country: 'Djibouti', male: 66.6, female: 68.8, overall: 64.6 },
	{ country: 'Ethiopia', male: 66.2, female: 68.2, overall: 64.4 },
	{ country: 'Gabon', male: 66.2, female: 68.9, overall: 64.2 },
	{ country: 'Yemen', male: 66.1, female: 67.8, overall: 64.4 },
	{ country: 'Eritrea', male: 65.9, female: 68.2, overall: 63.8 },
	{ country: 'Sudan', male: 65.1, female: 66.9, overall: 63.3 },
	{ country: 'Tanzania', male: 65, female: 66.8, overall: 63.2 },
	{ country: 'Mauritania', male: 64.7, female: 66.3, overall: 63.1 },
	{ country: 'Afghanistan', male: 64.5, female: 66, overall: 63 },
	{ country: 'Congo', male: 64.3, female: 65.7, overall: 62.8 },
	{ country: 'Papua New Guinea', male: 64.3, female: 65.6, overall: 63 },
	{ country: 'Comoros', male: 64.1, female: 65.9, overall: 62.4 },
	{ country: 'South Africa', male: 63.9, female: 67.4, overall: 60.5 },
	{ country: 'Ghana', male: 63.8, female: 64.9, overall: 62.7 },
	{ country: 'Malawi', male: 63.8, female: 66.9, overall: 60.7 },
	{ country: 'Haiti', male: 63.7, female: 65.8, overall: 61.5 },
	{ country: 'Liberia', male: 63.7, female: 65.1, overall: 62.3 },
	{ country: 'Zambia', male: 63.5, female: 66.4, overall: 60.5 },
	{ country: 'Namibia', male: 63.4, female: 66.2, overall: 60.4 },
	{ country: 'Kenya', male: 63.3, female: 68.7, overall: 64 },
	{ country: 'Uganda', male: 63, female: 65.2, overall: 60.7 },
	{ country: 'Niger', male: 62, female: 63.2, overall: 60.9 },
	{ country: 'Gambia', male: 61.7, female: 63.2, overall: 60.4 },
	{ country: 'Benin', male: 61.5, female: 63, overall: 59.9 },
	{ country: 'Burkina Faso', male: 61.2, female: 61.9, overall: 60.4 },
	{ country: 'Burundi', male: 61.2, female: 63, overall: 59.4 },
	{ country: 'Guinea', male: 61.2, female: 61.7, overall: 60.5 },
	{ country: 'Zimbabwe', male: 61.2, female: 62.6, overall: 59.5 },
	{ country: 'Angola', male: 60.8, female: 63.7, overall: 58.1 },
	{ country: 'Togo', male: 60.8, female: 61.6, overall: 59.9 },
	{ country: 'Congo (the Democratic Republic of the)', male: 60.4, female: 61.9, overall: 58.9 },
	{ country: 'Mozambique', male: 60.2, female: 63, overall: 57.1 },
	{ country: 'Eswatini', male: 59.4, female: 64, overall: 55.3 },
	{ country: 'Cameroon', male: 58.9, female: 60.2, overall: 57.7 },
	{ country: 'Mali', male: 58.9, female: 59.6, overall: 58.1 },
	{ country: 'Equatorial Guinea', male: 58.4, female: 59.6, overall: 57.4 },
	{ country: 'Guinea-Bissau', male: 58, female: 59.9, overall: 56 },
	{ country: 'South Sudan', male: 57.6, female: 59.1, overall: 56.1 },
	{ country: "CÃ´te d'Ivoire", male: 57.4, female: 58.7, overall: 56.3 },
	{ country: 'Nigeria', male: 54.3, female: 55.2, overall: 53.5 },
	{ country: 'Sierra Leone', male: 54.3, female: 55.1, overall: 53.5 },
	{ country: 'Chad', male: 54, female: 55.4, overall: 52.6 },
	{ country: 'Lesotho', male: 53.7, female: 57, overall: 50.6 },
	{ country: 'Central African Republic', male: 52.8, female: 55, overall: 50.6 },
];
const results = [];
fs.createReadStream('countries.csv')
	.pipe(stripBom())
	.pipe(csv({ separator: ';' }, ['country', 'alpha2', 'alpha3', 'numeric']))
	.on('data', data => {
		data['numeric'] = parseInt(data['numeric']);
		let i = lifeExpectancies.findIndex(x => x['country'] == data['country']);
		if (i !== -1) {
			data['male'] = lifeExpectancies[i]['male'];
			data['female'] = lifeExpectancies[i]['female'];
			data['overall'] = lifeExpectancies[i]['overall'];
		} else {
			data['male'] = null;
			data['female'] = null;
			data['overall'] = null;
		}
		results.push(data);
	})
	.on('end', () => {
		console.table(results);
		// save list to file
		fs.appendFileSync(
			'../index.ts',
			countryInterface + 'export const countryList: Country[] = ' + JSON.stringify(results),
			{
				encoding: 'utf8',
			}
		);
	});
